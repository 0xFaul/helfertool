{% extends "registration/admin/base.html" %}
{% load staticfiles %}
{% load i18n %}
{% load bootstrap3 %}

{% block title %}{{ job.name }} - {{ event.name }}{% endblock %}

{% block admincontent %}
    <h2>{% blocktrans with jobname=job.name%}Helpers: {{ jobname }}{% endblocktrans %}</h2>

    <p>
        {% bootstrap_icon "download-alt" %}
        &nbsp;{% trans "Export" %}:
        &nbsp;<a href="{% url 'jobexcel' event.url_name job.pk %}" class="icon">
            <img src="{% static "registration/img/icon-xls.svg" %}" class="icon" />
        </a>
    </p>

    <h3>{% trans "Coordinators" %}</h3>
    {% if job.coordinators.count == 0 %}
        <p class="text-muted">{% trans "There are no coordinators for this job." %}</p>
    {% else %}
        {% include "registration/admin/helpers_table.html" with event=event job=job helpers=job.coordinators.all %}
    {% endif %}

    <p>
        <a href="{% url 'add_coordinator' event.url_name job.pk %}">
            {% bootstrap_icon "plus" %}
            {% trans "Add coordinator" %}
        </a>
   </p>

    {# iterate over days #}
    {% for day, shifts in job.shifts_by_day.items %}
        <h3>{{ day }}</h3>
        {# iterate over shifts on this day #}
        {% for shift in shifts %}
            <h4>{{ shift.time_hours }}
                ({{ shift.num_helpers }} von {{ shift.number}})</h4>

            {% if shift.helper_set.count == 0 %}
                <p class="text-muted">{% trans "Nobody is registered for this shift." %}</p>
            {% else %}
                {% include "registration/admin/helpers_table.html" with event=event job=job helpers=shift.helper_set.all %}
            {% endif %}

            {% if not shift.is_full %}
                <p>
                    <a href="{% url 'add_helper' event.url_name shift.pk %}">
                        {% bootstrap_icon "plus" %}
                        {% trans "Add helper" %}
                    </a>
               </p>
           {% endif %}
        {% endfor %}
    {% endfor %}
{% endblock %}
