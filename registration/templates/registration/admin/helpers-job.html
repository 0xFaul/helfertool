{% extends "registration/admin/base.html" %}
{% load staticfiles %}

{% block title %}{{ job.name }} {{ event.name }}{% endblock %}

{% block admincontent %}
    <h2>Helfer: {{ job.name }}</h2>

    <p>Export:
        <a href="{% url 'jobexcel' event.url_name job.pk %}">
            <img src="{% static "registration/img/icon-xls.svg" %}" class="icon" />
        </a>
    </p>

    {# iterate over days #}
    {% for day, shifts in job.shifts_by_day.items %}
        <h3>{{ day }}</h3>
        {# iterate over shifts on this day #}
        {% for shift in shifts %}
            <h4>{{ shift.time_hours }}
                ({{ shift.num_helpers }} von {{ shift.number}})</h4>
            <table class="helpers">
                <tr>
                    <th>Vorname</th>
                    <th>Nachname</th>
                    <th>E-Mail</th>
                    <th>Handy</th>
                    {% if event.ask_shirt %}
                    <th>T-Shirt</th>
                    {% endif %}
                    {% if event.ask_vegetarian %}
                    <th>Vegetarier</th>
                    {% endif %}
                    <th>Kommentar</th>
                    <th>Anmeldezeit</th>
                </tr>
            {% for helper in shift.helper_set.all|dictsort:"timestamp" %}
                <tr>
                    <td>{{ helper.prename }}</td>
                    <td>{{ helper.surname }}</td>
                    <td>{{ helper.email }}</td>
                    <td>{{ helper.phone }}</td>
                    {% if event.ask_shirt %}
                    <td>{{ helper.get_shirt_display }}</td>
                    {% endif %}
                    {% if event.ask_vegetarian %}
                    <td>{{ helper.vegetarian | yesno }}</td>
                    {% endif %}
                    <td>{{ helper.comment }}</td>
                    <td>{{ helper.timestamp }}</td>
                </tr>
            {% endfor %}
            </table>
        {% endfor %}
    {% endfor %}
{% endblock %}
